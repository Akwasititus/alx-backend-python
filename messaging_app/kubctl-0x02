#!/bin/bash

# Deploy blue version
echo "Deploying BLUE version..."
kubectl apply -f blue_deployment.yaml

# Deploy green version
echo "Deploying GREEN version..."
kubectl apply -f green_deployment.yaml

# Apply service
echo "Applying Service..."
kubectl apply -f kubeservice.yaml

# Wait a bit for pods to start
sleep 10

# Check running pods
echo "Current Pods:"
kubectl get pods

# Check logs for green version to detect issues
GREEN_POD=$(kubectl get pods -l version=green -o jsonpath='{.items[0].metadata.name}')
echo "Checking logs for green pod: $GREEN_POD"
kubectl logs $GREEN_POD
